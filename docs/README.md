## 미션 - 크리스마스 프로모션


## 코드짜기전 최대의 유의 사항
- 클래스를 나누어라
- 큰 기능별 클래스와 작은 기능별 메서드
- 모든 에러에는 throw로 예외 발생시키고 [ERROR]메세지 출력 후 입력 다시 받음

- 할인은 중복
- 총 혜택 금액 = 총 할인 금액 + 증정 메뉴 금액
- ㄴ차등 이벤트 배지

## 입력받은 메뉴 분류가 핵심 관건

### 할인이 어느만큼 되는지가 그 다음 관건
- 평일 할인(일요일~목요일): 평일에는 디저트 메뉴를 메뉴 1개당 2,023원 할인

- 주말 할인(금요일, 토요일): 주말에는 메인 메뉴를 메뉴 1개당 2,023원 할인
* 일요일은 평일에 들어간다

- 특별 할인: 이벤트 달력에 별이 있으면 총주문 금액에서 1,000원 할인
* 일요일은 평일에 들어가지만 별이 있다 - 3,10,17,24,31
* 그 외 특별할인 날: 25일

- 증정 이벤트: 할인전 총 주문 금액이 12만원 이상일 때 샴페인 1개 증정
* 혜택 금액에 이 샴페인 금액(25000원, 역시 하드코딩 주의)이 포함된다

- 기간: 12월 1일부터 31일까지.(디데이 할인은 25일까지)

- 크리스마스 디데이 할인: 1,000원으로 시작하여 크리스마스가 다가올수록 날마다 할인 금액이 100원씩 증가
- 총주문 금액에서 해당 금액만큼 할인
(e.g. 시작일인 12월 1일에 1,000원, 2일에 1,100원, ..., 25일엔 3,400원 할인)
* 이벤트 기간이 25일까지 이므로 이후는 디데이 할인은 없다

#### 예외사항
- 음료만 주문시 주문 금지, 메뉴 개수가 20개 초과일 수 없다
- 총주문 금액 10000원 이상부터 이벤트 적용
- 모든 에러는 throw로 예외 발생후 [ERROR]로 시작. 입력 다시 받음

### 입력받아야 할 사항
1. 날짜(할인(=혜택)에 영향), 
2. 메뉴

- 1. 날짜의 유의 사항
- 날짜는 1이상 31이하 숫자로만(하드코딩에 유의)
- 날짜가 1이상 31이하의 숫자가 아닌경우 "[ERROR] 유효하지 않은 날짜입니다. 다시 입력해 주세요." 출력. 
- 25가 넘을 때와 25 이내일 때 따로 구분하여 처리
- 할인 금액과 이벤트가 달라짐

- 2. 메뉴의 유의 사항
- 없는 메뉴 입력시 :  "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요." 메세지 출력
- 메뉴의 개수는 1이상 아닐시 : "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요." 출력
-  메뉴의 형식이 아닐시 : "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요." 출력
- 중복 메뉴 입력시(e.g. 시저샐러드-1,시저샐러드-1) : "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요." 출력
- 전체 메뉴를 객체로 저장하여 메뉴 입력후 불러와서 비교하기
- 예시: {양송이수프:0, 타파스:0, ...} 이런식으로 처음에는 value가 0
- ㄴ 입력받은 것은 ,를 기준으로 배열로 저장(split)후 배열의 각 원소에서 -를 기준으로 앞을 객체의 key와 비교하여 일치하면 -기준으로 뒤를 그 key값의 value로 넣는다. 
- ㄴ 입력받은 것을 , 로 배열로 처음 만들었을 때 그 배열의 길이 만큼 반복문을 돌려서 그 배열의 첫번째 항이 전체 메뉴의 객체의 key값과 맞는지 비교하는 식으로 하면 될듯

- 음료만 입력시 '[ERROR]'출력
* 음료를 제일 마지막으로 해서 메뉴 입력한 객체의 value값을 배열로 만들었을 때 마지막 3개를 잘라서 새로운 배열을 만들었을 때 그 배열의 원소가 모두 0 이면(==[0, 0, 0,..., 0]) 음료만 주문한 것이므로 주문불가 에러

- 메뉴가 20개 초과시 '[ERROR]'출력
* 메뉴 입력한 객체의 value값을 모두 합칠 때 20개가 넘으면 주문불가 에러

## 출력해야 할 사항
 1. 주문메뉴
 2. 할인 전 총주문 금액
 3. 증정 메뉴
 4. 혜택 내역
 5. 총혜택 금액
 6. 할인 후 예상 결제 금액
 7. 12월 이벤트 배치

 1. 주문메뉴의 주의 사항
 - 입력은 타파스-1,제로콜라-1의 형태로 하지만 출력은 
 타파스 1개
 제로콜라 1개
 의 식으로 해야 한다. 
 - \n 의 사용에 유의하고 문자와 숫자를 따로 표시하게.
 * -를 기준으로 앞은 메뉴, 뒤는 개수로 따로 변수로 입력받아도 될 듯하다
 * 인덱스 기준으로 마지막 1개는 숫자, 0부터 마지막2개 전까지는 메뉴로 받아도 될 것 같지만 이 경우는 숫자가 2자리인 경우 문제 생김
 
 2. 할인전 총 주문 금액의 주의사항
 - 주문 메뉴에서 숫자도 문자로 일단 받을테니 변환 필요. 단순 총 금액
 * 증정 메뉴 금액은 총 주문 금액에 들어가지 않는다

 3. 증정 메뉴
 - 없을 때는 '없음' 표시, 있을 때는 '샴페인 1개' 표시
 * 할인전 총 주문 금액의 크기에 따라 true false이므로 '샴페인 1개' 를 어떻게 할 것인지 고려해야 함.(하드코딩 할 것인지 말 것인지)
 
 4. 혜택 내역
 - 없을 때는 '없음' 표시. 2.의 할인전 총 주문금액이 10000원 이하일 때 혜택 있음(10000원 이하일 때 없음 표시)
 - 각 이벤트 별로 할인된 금액을 - 표시하여 나타낸다.
 - 각 이벤트 : -(금액)원(줄바꿈)식으로 표시한다
 - 각 이벤트에서 해당 금액이 0 일 때는 표시하지 않음.
 - 증정 메뉴가 있을때는 증정 이벤트: -25000원 추가
 * 증정 메뉴에 대해서는 금액이 120000원 넘길 때 true로 만들어 '증정 이벤트: -25000원'을 통째로 하드 코딩할 것인지 말것인지 고려해야 함

 5. 총 혜택 금액
 - 혜택 내역의 총합.
 - 증정 메뉴의 여부와 그것의 하드코딩 여부에 따라 단순합이냐 추가 코딩의 여부가 나뉨. 
 - -붙이는 것에 유의

 6. 할인 후 예상 결제 금액
 - 총 금액에서 할인금액을 뺀 것. 다만 증정 금액은 할인 금액에 포함되지 않으니 주의
 * 2,4,5,6의 모든 금액은 천원 단위에 , 붙일것!(e.g. 1000원 -> 1,000원)

 7. 12월 이벤트 배지
 - 혜택 금액에 따른 배지 부여 
 * 혜택 금액은 할인 금액이 아니다
 * 5번의 금액에서 -를 뺸 것(굳이 -를 빼지 않고 ~-20000, -20000~ -10000, -10000~ -5000 으로 나누는 방법도 있으니 간단한 것으로 생각할것)
 * 5000원 이상 10000원 미만은 별, 10000원 이상 20000원 이하는 트리, 20000원 이상은 산타

 * 1~7의 출력에는 줄띄움이 들어가 있어 각 메뉴와 메뉴 사이에 1번의 줄띄움이 존재하게 한다.

#### 11.12 기능 완성(했다고 생각한 뒤) 발생한 문제
- 무한 루프 : console.log 찍어서 루프 확인해 보니 date 받고 오류시 다시 date를 받는게 아니라 menu를 받고 오류시 menu로 가지 않고 그제서야 date로 가고 반복 - 그래서 꼬인듯 - date 받아오고나서 menu 받을 수 있게 date 메서드 속에 menu 넣어봄
- calculater정리. 받아오는 메소드를 최소화하는 방향으로. 루프는 아직 해결중

#### 11.13 콘솔로그 찍어보니 기본적인 문제 발생 확인
- new class{}하면 class{key : value}로 return된다는 것을 모르고 있었음. 단순히 value만 return될 것이라 생각했기에 import된 class에서 value 받아오는 과정 추가 하여 전체 갈아엎기
- 필드에 # 붙이는 것의 의미를 크게 생각하지 않음. default는 import,export되지 않는다는 것 확인하고 변경중
- 현재 수정해야 할 오류: 주말할인과 평일 할인이 같이 됨. console.log에 분명히 표시 되는데 인식 못함. try-catch에 무한반복
- 수정된 사항: 주말할인과 평일할인 같이 되는 부분
- 수정해야 할 사항: console.log에 표시되는데 테스트코드 안됨/ 에러시 try-catch에 무한반복 
- 방법: outputview에 있는 계산식 새로운 클래스에서 하게 하고 output에서는 딱 프린트만 하게 하기 시도/ 일단 while문 만들고 다른 것 찾아보기

#### 11.14 해결된 사항과 해결해야 할 사항
- 해결된 사항: 테스트코드 정상 작동시킴. 
- 어제 생각한 해결방안은 아님. 처음 app에서 await를 하지 않아 실행되지 않던 것. this.#controller.start(); 앞에 await 추가함으로써 해결.
- 해결해야 할 사항: 무한 반복 - 테스트코드 보니 정상 작동이면 에러 띄운 뒤 해산물파스타 2개로 해서 나와야 함.
- 문제 사항: 값입력 받은 후 오류이면 '다음' 값을 입력 받아야 하는데 처음 값을 계속 입력받아서 무한 반복이 됨.
- 해결함: catch에서 단순 await this.getDate();이면 처음값을 그대로 받아옴. return await this.getDate();해야 그 다음 값을 받아옴. 해결


#### 추가 테스트
- 단위 테스트 및 예외 상황 테스트 추가 작성하고 확인
- 단위 테스트: 배지가 입력값에 맞게 잘 나오는지 확인, 할인 상황에 맞게 나오는지 확인
- 예외 상황 테스트: 날짜가 1이상 31 이하의 범위가 아닐때도 오류 나오는지 확인, 메뉴가 20개 넘을 때도, 음료만 주문할 때도, 중복 메뉴 주문할 때도 문제없이 오류 출력하는 지 확인

### 기능 구현 목록

#### 1. 날짜를 입력받는다
- 날짜를 입력받는다 : getDate
- 숫자로 받되 1 이상 31이하여야 한다
- 입력받은 날짜를 저장한다 : this.date
- 잘못된 입력이 있을 경우 [ERROR]출력하고 다시 받도록 한다

#### 2. 메뉴를 입력받는다
- 메뉴를 입력받는다 : getMenu
- 메뉴-1,메뉴-2 의 형태로 입력받되 중복된 메뉴가 있으면 안되고 메뉴의 총 합이 20개가 넘으면 안된다. 음료수만 있어도 안되고, 메뉴의 개수가 숫자가 아니어도 안된다
- 입력받은 메뉴를 메뉴의 리스트형태로 저장한다 : this.menulist
- 입력받은 메뉴의 개수를 따로 저장한다 : this.menucount
- 잘못된 입력이 있을 경우 [ERROR]출력하고 다시 받도록 한다

#### 3. 할인전 금액을 계산한다
- 할인전 금액을 계산한다 : beforeDiscount
- 할인전 금액은 모든 메뉴의 가격과 개수를 곱하여 더한 값이고 이를 저장한다 : this.BeforeDiscount

#### 4. 할인되는 금액을 계산한다
- 할인전 금액이 10000원 이하이면 할인하지 않는다 - 10000원은 하드코딩하지 않고 상수로 설정
- 날짜가 25일 이하이면 크리스마스 디데이 할인을 적용하고 그 이후이면 적용하지 않는다
- 그 외 다른 할인은 공통적으로, 디저트 메뉴 할인인 평일 할인과 메인메뉴 할인인 주말 할인, 별표 표시된 날 할인인 특별 할인이 있다
- 각 날짜는 하드코딩하지 않고 배열로 상수를 만든후 포함여부로 결정

#### 5. 증정 메뉴를 결정한다
- 할인전 금액이 12만 이상이면 증정메뉴가 있다(샴페인) - 금액의 크기도 상수로 설정
- 증정메뉴가 있는지를 판별하는 메서드 : present
- 여부를 판별하여 저장 : this.Present

#### 6. 할인 후 금액을 결정한다
- 혜택 금액은 따로 있는데 할인 금액에 증정메뉴 금액을 더한 것이므로 출력시 따로 정한다 
- 할인된 총 금액을 구하여 저장 : benefitPrices메서드, this.totalDiscountPrice
- 할인전 금액에서 할인되는 총 금액을 뺀다

#### 7. 결과 출력
- 여기에서는 printAll 메서드에서 관리했고, 자세한 출력(이하 메서드)은 OutputView 내부의 메서드이다
- 입력받은 날짜와 메뉴로 만든 menulist를 OutputView를 통해 출력한다 : printMenu
- 할인전 금액을 출력한다 : printBeforeDiscount
- 할인 여부를 측정하여 따로 출력한다 : PrintYesBenefit, PrintNoBenefit
- 할인 여부가 true일 경우 증정메뉴 여부에 따라 출력을 달리 하고 그 후 혜택 내역(printBenefit)과 총혜택 금액(printTotalBenefit)을 출력한다
- 할인후 금액을 위에서 계산한 값(this.afterDiscount)을 받아와 출력한다 : printAfterBenefit
- 배지를 출력한다 : 배지는 OutputView에서 따로 연결하여 값을 구한 후(checkBadge) 바로 출력한다
